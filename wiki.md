
# مستندات سیستم Admin Server و Mini Server

این مستند به توضیح نحوه عملکرد دو بخش اصلی پروژه یعنی **Admin Server** و **Mini Server** می‌پردازد تا افرادی که تازه به پروژه ملحق می‌شوند بتوانند به سرعت با ساختار و روند کار آشنا شوند.

---

## 📌 مقدمه

این سیستم از دو بخش اصلی تشکیل شده است:

1. **Admin Server**  
   این بخش وظیفه مدیریت جلسات (Meetings) را دارد و با سرور Django برای دریافت اطلاعات جلسه‌ها در ارتباط است.
   
2. **Mini Server**  
   این بخش برای هر جلسه به صورت جداگانه راه‌اندازی می‌شود و وظایف مربوط به آن جلسه را اجرا می‌کند.

ارتباط بین این دو بخش از طریق **API** برقرار می‌شود.

---

## 🛠 ساختار کلی سیستم

```
Django API  <---->  Admin Server  <---->  Mini Server (برای هر جلسه)
```

- **Django API**: اطلاعات جلسه‌ها را شامل `id`, `name`, `date_time`, `port`, `is_running` ارائه می‌دهد.
- **Admin Server**: بررسی می‌کند که چه جلسه‌هایی فعال یا غیرفعال هستند و Mini Serverها را راه‌اندازی یا متوقف می‌کند.
- **Mini Server**: مسئول اجرای وظایف مربوط به یک جلسه مشخص.

---

## ⚙ نحوه عملکرد Admin Server

1. **دریافت لیست جلسات**  
   Admin Server یک درخواست HTTP به API جنگو ارسال می‌کند و اطلاعات جلسه‌ها را به صورت JSON دریافت می‌کند.
   
   مثال خروجی:
   ```json
   [
       {
           "id": 14,
           "name": "Sprint Planning",
           "date_time": "2025-06-01T14:00:00Z",
           "port": 8082,
           "is_running": false
       },
       {
           "id": 17,
           "name": "Sprint Planning",
           "date_time": "2025-08-13T11:17:20Z",
           "port": 8081,
           "is_running": true
       }
   ]
   ```

2. **بررسی زمان جلسه‌ها**  
   برای هر جلسه، `end_time` یک ساعت بعد از `date_time` محاسبه می‌شود.

3. **راه‌اندازی Mini Server برای جلسات فعال**  
   اگر جلسه در حال اجرا باشد (`is_running: true`) و هنوز Mini Server آن اجرا نشده باشد، Admin Server یک **Subprocess** برای اجرای آن ایجاد می‌کند.

4. **خاموش کردن Mini Server برای جلسات پایان یافته**  
   اگر جلسه تمام شده باشد یا `is_running: false` باشد، پروسه Mini Server متوقف می‌شود.

---

## ⚙ نحوه عملکرد Mini Server

- Mini Server یک سرور کوچک پایتون است که با پورت اختصاصی که از Admin Server دریافت کرده، اجرا می‌شود.
- هر Mini Server مسئول مدیریت همان جلسه خاص است و از طریق پورت اختصاصی به سرویس‌ها یا کلاینت‌ها پاسخ می‌دهد.

مثال اجرای دستی Mini Server:
```bash
python mini_server.py 8081
```

---

## 📡 سیستم ارسال و دریافت اطلاعات

- **ارتباط بین Admin Server و Django API** از طریق **HTTP GET** انجام می‌شود.
- **ارتباط بین Admin Server و Mini Serverها** به صورت **محلی (Local Process Communication)** از طریق پورت اختصاصی انجام می‌شود.
- Mini Serverها می‌توانند درخواست‌های کلاینت‌ها را مدیریت کنند و داده‌ها را در همان پورت ارائه دهند.

---

## 🚀 شروع به کار

1. اطمینان از نصب پایتون (نسخه 3.10 یا بالاتر).
2. اجرای Admin Server:
   ```bash
   python adminserver.py
   ```
3. اطمینان از اینکه **Django API** فعال و در دسترس است.
4. مشاهده لاگ‌ها برای بررسی اجرای Mini Serverها.

---

## 📝 نکات مهم

- مسیر اجرای Mini Server در Admin Server باید صحیح باشد (در ویندوز از `python` و در لینوکس از `python3` استفاده شود).
- پورت هر جلسه باید یکتا باشد.
- اطمینان حاصل کنید که پس از پایان هر جلسه، Mini Server مربوطه به درستی متوقف شود تا از اشغال بیهوده منابع جلوگیری شود.
